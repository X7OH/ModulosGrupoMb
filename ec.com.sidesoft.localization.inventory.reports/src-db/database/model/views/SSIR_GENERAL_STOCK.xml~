<?xml version="1.0"?>
  <database name="VIEW SSIR_GENERAL_STOCK">
    <view name="SSIR_GENERAL_STOCK"><![CDATA[SELECT a.name, a.m_product_id AS ssir_general_stock_id, a.ad_client_id, a.ad_org_id, a.isactive, a.created, a.createdby, a.updated, a.updatedby, a.value, a.m_product_id, a.m_product_category_id, a.c_taxcategory_id, a.em_sgmr_product_category_id AS sgmr_product_category_id, a.em_sgmr_prod_subcategory_id AS sgmr_product_subcategory_id, a.description, a.weight, a.upc, a.m_brand_id, a.c_bpartner_id, COALESCE(sum(n.movementqty), 0) AS stock, 0.00 AS purchaseprice, j.pricelist AS salesprice, m_get_product_cost(a.m_product_id, to_date(now()), 'AVA') AS avgprice, p.m_warehouse_id, n.m_locator_id, q.c_uom_id FROM m_product a LEFT JOIN m_productprice j ON j.m_product_id = a.m_product_id LEFT JOIN m_pricelist_version k ON k.m_pricelist_version_id = j.m_pricelist_version_id LEFT JOIN m_pricelist l ON l.m_pricelist_id = k.m_pricelist_id LEFT JOIN m_transaction n ON n.m_product_id = a.m_product_id LEFT JOIN m_locator o ON o.m_locator_id = n.m_locator_id LEFT JOIN m_warehouse p ON p.m_warehouse_id = o.m_warehouse_id LEFT JOIN m_product_uom q ON q.m_product_id = a.m_product_id WHERE l.isdefault = 'Y' AND l.issopricelist = 'Y' GROUP BY a.name, a.m_product_id, a.ad_client_id, a.ad_org_id, a.isactive, a.created, a.createdby, a.updated, a.updatedby, a.value, a.c_uom_id, a.m_product_category_id, a.c_taxcategory_id, a.em_sgmr_product_category_id, a.em_sgmr_prod_subcategory_id, a.description, a.weight, a.upc, a.m_brand_id, a.c_bpartner_id, j.pricelist, p.m_warehouse_id, n.m_locator_id, q.c_uom_id ORDER BY a.name]]></view>
  </database>
