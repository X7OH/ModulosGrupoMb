<?xml version="1.0" encoding="UTF-8"?>
<!--
 ************************************************************************************
 * Copyright (C) 2017-2018 Openbravo S.L.U.
 * Licensed under the Openbravo Commercial License version 1.0
 * You may obtain a copy of the License at http://www.openbravo.com/legal/obcl.html
 * or in the legal folder of this module distribution.
 ************************************************************************************
-->

<output>
  <ticket>
    <line>
        <image>ticket-image.png</image>
    </line>
    <line>
      <%
        var title;
    
          title = OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('GCNV_LblCreditNote'));
       
       %>
      <text align="center" length="42"><%= title %></text>
    </line>
    <line></line>
    <line>
      <text align="center" length="42"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_tckheader_line1'))%></text>
    </line>
    <line>
      <text align="center" length="42"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_tckheader_line2'))%></text>
    </line>
    <line></line>
    <line>
      <text align="left" length="22"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('GCNV_LblGiftCardID')) %></text>
      <text><%= OB.UTIL.encodeXMLComponent(giftCardData.get('giftCardId')) %></text>
    </line>
      <%
      if (giftCardData.get('alertStatus')) {
        %>
        <line>
          <text align="left" length="22"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('GCNV_LblStatus')) %></text>
          <text><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('GCNV_LblStatus-' + giftCardData.get('alertStatus'))) %></text>
        </line>
      <%
      }
      %>
      
    <line>
      <text align="left" length="22"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('GCNV_LblBusinessPartner')) %></text>
      <text><%= OB.UTIL.encodeXMLComponent(giftCardData.get('businessPartnerName')) %></text>
    </line>
    <line></line>
      <%
        if (!OB.UTIL.isNullOrUndefined(giftCardData.get('amount'))) {
          %>
          <line>
            <text align="left" length="32"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('GCNV_LblAmount')) %></text>
            <text><%= OB.I18N.formatCurrency(giftCardData.get('amount')) %></text>
          </line>
          <%
          if (!OB.UTIL.isNullOrUndefined(giftCardData.get('currentamount'))) {
            %>
            <line>
              <text align="left" length="32"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('GCNV_LblCurrentAmount')) %></text>
              <text><%= OB.I18N.formatCurrency(giftCardData.get('currentamount')) %></text>
            </line>
          <%
          }
        } else if (giftCardData.get('summaryList')) {
          %>
          <line>
            <text align ="left" length="22"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('GCNV_LblProduct')) %></text>
            <text align ="right" length="10"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('GCNV_ShortInitialQuantity')) %></text>
            <text align ="right" length="10"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('GCNV_ShortCurrentQuantity')) %></text>
          </line>
          <line>
            <text>------------------------------------------</text>
          </line>
          <% 
            var lines = giftCardData.get('summaryList'), line;
            for (var i = 0; i < lines.length; i++) {
              line = lines[i];
              %>
            <line>
              <text align ="left" length="22"><%= OB.UTIL.encodeXMLComponent(line.product$_identifier) %></text>
              <text align ="right" length="10"><%= line.quantity %></text>
              <text align ="right" length="10"><%= line.currentquantity %></text>
            </line>
          <%
            }
        }
      %>
    <line></line>
    <%
      if (giftCardData.get('expirationDate')) {
      %>
    <line>
      <text align="left" length="22"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBGCNE_GCOwner')) %></text>
      <text><%= OB.UTIL.encodeXMLComponent(giftCardData.get('gcOwnerName')) %></text>
    </line>
    <%
      }
      if (giftCardData.get('expirationDate')) {
      %>
        <line>
          <text align="left" length="22"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBGCNE_ExpirationDate')) %></text>
          <text><%= giftCardData.get('expirationDate') %></text>
        </line>
      <%
      }
    %>
    <line>
      <barcode type="CODE128" position="left"><%= OB.UTIL.encodeXMLComponent(giftCardData.get('giftCardId')) %></barcode>
    </line>
    
  </ticket>

</output>